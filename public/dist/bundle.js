!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=9)}([function(t,e){kontra={init(t){var e=this.canvas=document.getElementById(t)||t||document.querySelector("canvas");if(!e)throw Error("You must provide a canvas element for the game");this.context=e.getContext("2d"),this.context.imageSmoothingEnabled=!1,this._init()},_noop:new Function,_tick:new Function,_init:new Function},function(){let t,e=/(jpeg|jpg|gif|png)$/,n=/(wav|mp3|ogg|aac)$/,i=/^no$/,r=/^\//,o=/\/$/,a=new Audio,s={wav:"",mp3:a.canPlayType("audio/mpeg;").replace(i,""),ogg:a.canPlayType('audio/ogg; codecs="vorbis"').replace(i,""),aac:a.canPlayType("audio/aac;").replace(i,"")};function c(t,e){return[t.replace(o,""),t?e.replace(r,""):e].filter(t=>t).join("/")}function u(t){return t.split(".").pop()}function h(t){let e=t.replace("."+u(t),"");return 2==e.split("/").length?e.replace(r,""):e}function d(e,n){return new Promise(function(i,r){let o=new Image;n=c(t.imagePath,e),o.onload=function(){let r=t._u(n,window.location.href);t.images[h(e)]=t.images[n]=t.images[r]=this,i(this)},o.onerror=function(){r("Unable to load image "+n)},o.src=n})}function l(e,n,i){return new Promise(function(r,o){if(e=[].concat(e).reduce(function(t,e){return s[u(e)]?e:t},i)){let i=new Audio;n=c(t.audioPath,e),i.addEventListener("canplay",function(){let i=t._u(n,window.location.href);t.audio[h(e)]=t.audio[n]=t.audio[i]=this,r(this)}),i.onerror=function(){o("Unable to load audio "+n)},i.src=n,i.load()}else o("cannot play any of the audio formats provided"+e)})}function f(e,n){return n=c(t.dataPath,e),fetch(n).then(function(t){if(!t.ok)throw t;return t.clone().json().catch(function(){return t.text()})}).then(function(i){let r=t._u(n,window.location.href);return"object"==typeof i&&t._d.set(i,r),t.data[h(e)]=t.data[n]=t.data[r]=i,i})}t=kontra.assets={images:{},audio:{},data:{},_d:new WeakMap,_u:(t,e)=>new URL(t,e).href,imagePath:"",audioPath:"",dataPath:"",load(){let t,i,r,o,a,s=[];for(o=0;r=arguments[o];o++)a=(i=u(t=[].concat(r)[0])).match(e)?d(r):i.match(n)?l(r):f(r),s.push(a);return Promise.all(s)},_canUse:s}}(),kontra.gameLoop=function(t){if(!(t=t||{}).update||!t.render)throw Error("You must provide update() and render() functions");let e,n,i,r,o=t.fps||60,a=0,s=1e3/o,c=1/o,u=!1===t.clearCanvas?kontra._noop:function(){kontra.context.clearRect(0,0,kontra.canvas.width,kontra.canvas.height)};function h(){if(n=requestAnimationFrame(h),i=performance.now(),r=i-e,e=i,!(r>1e3)){for(kontra._tick(),a+=r;a>=s;)d.update(c),a-=s;u(),d.render()}}let d={update:t.update,render:t.render,isStopped:!0,start(){e=performance.now(),this.isStopped=!1,requestAnimationFrame(h)},stop(){this.isStopped=!0,cancelAnimationFrame(n)},_frame:h,set _last(t){e=t}};return d},function(){let t={},e={},n={13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};for(let t=0;t<26;t++)n[65+t]=(10+t).toString(36);for(i=0;i<10;i++)n[48+i]=""+i;addEventListener("keydown",function(i){let r=n[i.which];e[r]=!0,t[r]&&t[r](i)}),addEventListener("keyup",function(t){e[n[t.which]]=!1}),addEventListener("blur",function(t){e={}}),kontra.keys={map:n,bind(e,n){[].concat(e).map(function(e){t[e]=n})},unbind(e,n){[].concat(e).map(function(e){t[e]=n})},pressed:t=>!!e[t]}}(),function(){let t,e=[],n=[],i={},r=[],o={},a={0:"left",1:"middle",2:"right"};function s(e){let n=e.x,i=e.y;e.anchor&&(n-=e.width*e.anchor.x,i-=e.height*e.anchor.y);let r=t.x-Math.max(n,Math.min(t.x,n+e.width)),o=t.y-Math.max(i,Math.min(t.y,i+e.height));return r*r+o*o<t.radius*t.radius}function c(){let i,r,o=n.length?n:e;for(let e=o.length-1;e>=0;e--)if(r=(i=o[e]).collidesWithPointer?i.collidesWithPointer(t):s(i))return i}function u(t){let e=void 0!==t.button?a[t.button]:"left";o[e]=!0,f(t,"onDown")}function h(t){let e=void 0!==t.button?a[t.button]:"left";o[e]=!1,f(t,"onUp")}function d(t){f(t,"onOver")}function l(t){o={}}function f(e,n){if(!kontra.canvas)return;let r,o;-1!==["touchstart","touchmove","touchend"].indexOf(e.type)?(r=(e.touches[0]||e.changedTouches[0]).clientX,o=(e.touches[0]||e.changedTouches[0]).clientY):(r=e.clientX,o=e.clientY);let a,s=kontra.canvas.height/kontra.canvas.offsetHeight,u=kontra.canvas.getBoundingClientRect(),h=(r-u.left)*s,d=(o-u.top)*s;t.x=h,t.y=d,e.target===kontra.canvas&&(e.preventDefault(),(a=c())&&a[n]&&a[n](e)),i[n]&&i[n](e,a)}t=kontra.pointer={x:0,y:0,radius:5,track(t){[].concat(t).map(function(t){t._r||(t._r=t.render,t.render=function(){e.push(this),this._r()},r.push(t))})},untrack(t,e){[].concat(t).map(function(t){t.render=t._r,t._r=e;let n=r.indexOf(t);-1!==n&&r.splice(n,1)})},over:t=>-1!==r.indexOf(t)&&c()===t,onDown(t){i.onDown=t},onUp(t){i.onUp=t},pressed:t=>!!o[t]},kontra._tick=function(){n.length=0,e.map(function(t){n.push(t)}),e.length=0},kontra._init=function(){kontra.canvas.addEventListener("mousedown",u),kontra.canvas.addEventListener("touchstart",u),kontra.canvas.addEventListener("mouseup",h),kontra.canvas.addEventListener("touchend",h),kontra.canvas.addEventListener("blur",l),kontra.canvas.addEventListener("mousemove",d),kontra.canvas.addEventListener("touchmove",d)}}(),kontra.pool=function(t){let e,n=0;if(!(t=t||{}).create||!(e=t.create())||!(e.update&&e.init&&e.isAlive))throw Error("Must provide create() function which returns an object with init(), update(), and isAlive() functions");return{_c:t.create,objects:[t.create()],size:1,maxSize:t.maxSize||1024,get(t){if(t=t||{},this.objects.length==n){if(this.size===this.maxSize)return;for(let t=0;t<this.size&&this.objects.length<this.maxSize;t++)this.objects.unshift(this._c());this.size=this.objects.length}let e=this.objects.shift();return e.init(t),this.objects.push(e),n++,e},getAliveObjects(){return this.objects.slice(this.objects.length-n)},clear(){n=this.objects.length=0,this.size=1,this.objects.push(this._c())},update(t){let e,i=this.size-1,r=Math.max(this.objects.length-n,0);for(;i>=r;)(e=this.objects[i]).update(t),e.isAlive()?i--:(this.objects=this.objects.splice(i,1).concat(this.objects),n--,r++)},render(){let t=Math.max(this.objects.length-n,0);for(let e=this.size-1;e>=t;e--)this.objects[e].render()}}},kontra.quadtree=function(t){return{maxDepth:(t=t||{}).maxDepth||3,maxObjects:t.maxObjects||25,_b:!1,_d:t.depth||0,_p:t.parent,bounds:t.bounds||{x:0,y:0,width:kontra.canvas.width,height:kontra.canvas.height},objects:[],subnodes:[],clear(){this.subnodes.map(function(t){t.clear()}),this._b=!1,this.objects.length=0},get(t){let e,n,i=[];for(;this.subnodes.length&&this._b;){for(e=this._g(t),n=0;n<e.length;n++)i.push.apply(i,this.subnodes[e[n]].get(t));return i}return this.objects},add(){let t,e,n,i;for(e=0;e<arguments.length;e++)if(n=arguments[e],Array.isArray(n))this.add.apply(this,n);else if(this._b)this._a(n);else if(this.objects.push(n),this.objects.length>this.maxObjects&&this._d<this.maxDepth){for(this._s(),t=0;i=this.objects[t];t++)this._a(i);this.objects.length=0}},_a(t,e,n){for(e=this._g(t),n=0;n<e.length;n++)this.subnodes[e[n]].add(t)},_g(t){let e=[],n=this.bounds.x+this.bounds.width/2,i=this.bounds.y+this.bounds.height/2,r=t.y<i&&t.y+t.height>=this.bounds.y,o=t.y+t.height>=i&&t.y<this.bounds.y+this.bounds.height;return t.x<n&&t.x+t.width>=this.bounds.x&&(r&&e.push(0),o&&e.push(2)),t.x+t.width>=n&&t.x<this.bounds.x+this.bounds.width&&(r&&e.push(1),o&&e.push(3)),e},_s(t,e,n){if(this._b=!0,!this.subnodes.length)for(t=this.bounds.width/2|0,e=this.bounds.height/2|0,n=0;n<4;n++)this.subnodes[n]=kontra.quadtree({bounds:{x:this.bounds.x+(n%2==1?t:0),y:this.bounds.y+(n>=2?e:0),width:t,height:e},depth:this._d+1,maxDepth:this.maxDepth,maxObjects:this.maxObjects,parent:this})}}},function(){class t{constructor(t,e){this._x=t||0,this._y=e||0}add(t,e){this.x+=(t.x||0)*(e||1),this.y+=(t.y||0)*(e||1)}clamp(t,e,n,i){this._c=!0,this._a=t,this._b=e,this._d=n,this._e=i}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t}set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}}kontra.vector=((e,n)=>new t(e,n)),kontra.vector.prototype=t.prototype;class e{init(t,e,n,i){for(e in t=t||{},this.position=kontra.vector(t.x,t.y),this.velocity=kontra.vector(t.dx,t.dy),this.acceleration=kontra.vector(t.ddx,t.ddy),this.width=this.height=this.rotation=0,this.ttl=1/0,this.anchor={x:0,y:0},this.context=kontra.context,t)this[e]=t[e];return(n=t.image)&&(this.image=n,this.width=void 0!==t.width?t.width:n.width,this.height=void 0!==t.height?t.height:n.height),this}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}get animations(){return this.anims}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}set animations(t){let e,n;for(e in this.anims={},t)this.anims[e]=t[e].clone(),n=n||this.anims[e];this.currentAnimation=n,this.width=this.width||n.width,this.height=this.height||n.height}isAlive(){return this.ttl>0}collidesWith(t){if(this.rotation||t.rotation)return null;let e=this.x-this.width*this.anchor.x,n=this.y-this.height*this.anchor.y,i=t.x,r=t.y;return t.anchor&&(i-=t.width*t.anchor.x,r-=t.height*t.anchor.y),e<i+t.width&&e+this.width>i&&n<r+t.height&&n+this.height>r}update(t){this.advance(t)}render(){this.draw()}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){this.velocity.add(this.acceleration,t),this.position.add(this.velocity,t),this.ttl--,this.currentAnimation&&this.currentAnimation.update(t)}draw(){let t=-this.width*this.anchor.x,e=-this.height*this.anchor.y;this.context.save(),this.context.translate(this.x,this.y),this.rotation&&this.context.rotate(this.rotation),this.image?this.context.drawImage(this.image,0,0,this.image.width,this.image.height,t,e,this.width,this.height):this.currentAnimation?this.currentAnimation.render({x:t,y:e,width:this.width,height:this.height,context:this.context}):(this.context.fillStyle=this.color,this.context.fillRect(t,e,this.width,this.height)),this.context.restore()}}kontra.sprite=(t=>(new e).init(t)),kontra.sprite.prototype=e.prototype}(),function(){class t{constructor(t,e){t=t||{},this.spriteSheet=t.spriteSheet,this.frames=t.frames,this.frameRate=t.frameRate,this.loop=void 0===t.loop||t.loop,e=t.spriteSheet.frame,this.width=e.width,this.height=e.height,this.margin=e.margin||0,this._f=0,this._a=0}clone(){return kontra.animation(this)}reset(){this._f=0,this._a=0}update(t){if(this.loop||this._f!=this.frames.length-1)for(t=t||1/60,this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render(t){t=t||{};let e=this.frames[this._f]/this.spriteSheet._f|0,n=this.frames[this._f]%this.spriteSheet._f|0,i=void 0!==t.width?t.width:this.width,r=void 0!==t.height?t.height:this.height;(t.context||kontra.context).drawImage(this.spriteSheet.image,n*this.width+(2*n+1)*this.margin,e*this.height+(2*e+1)*this.margin,this.width,this.height,t.x,t.y,i,r)}}kontra.animation=function(e){return new t(e)},kontra.animation.prototype=t.prototype;class e{constructor(t){if(!(t=t||{}).image)throw Error("You must provide an Image for the SpriteSheet");this.animations={},this.image=t.image,this.frame={width:t.frameWidth,height:t.frameHeight,margin:t.frameMargin},this._f=t.image.width/t.frameWidth|0,this.createAnimations(t.animations)}createAnimations(t){let e,n,i,r;for(r in t){if(n=(e=t[r]).frames,i=[],void 0===n)throw Error("Animation "+r+" must provide a frames property");[].concat(n).map(function(t){i=i.concat(this._p(t))},this),this.animations[r]=kontra.animation({spriteSheet:this,frames:i,frameRate:e.frameRate,loop:e.loop})}}_p(t,e){if(+t===t)return t;let n=[],i=t.split(".."),r=e=+i[0],o=+i[1];if(r<o)for(;e<=o;e++)n.push(e);else for(;e>=o;e--)n.push(e);return n}}kontra.spriteSheet=function(t){return new e(t)},kontra.spriteSheet.prototype=e.prototype}(),kontra.store={set(t,e){void 0===e?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(e))},get(t){let e=localStorage.getItem(t);try{e=JSON.parse(e)}catch(t){}return e}},kontra.tileEngine=function(t){let e=t.width*t.tilewidth,n=t.height*t.tileheight,i=document.createElement("canvas"),r=i.getContext("2d");i.width=e,i.height=n;let o={},a={},s=Object.assign({mapwidth:e,mapheight:n,_sx:0,_sy:0,get sx(){return this._sx},get sy(){return this._sy},set sx(t){this._sx=Math.min(Math.max(0,t),e-kontra.canvas.width)},set sy(t){this._sy=Math.min(Math.max(0,t),n-kontra.canvas.height)},render(){h(i)},renderLayer(t){let i=a[t],r=o[t];i||((i=document.createElement("canvas")).width=e,i.height=n,a[t]=i,s._r(r,i.getContext("2d"))),h(i)},layerCollidesWith(t,e){let n=c(e.y),i=u(e.x),r=c(e.y+e.height),a=u(e.x+e.width),s=o[t];for(let t=n;t<=r;t++)for(let e=i;e<=a;e++)if(s.data[e+t*this.width])return!0;return!1},tileAtLayer(t,e){let n=e.row||c(e.y),i=e.col||u(e.x);return o[t]?o[t].data[i+n*s.width]:-1},_r:function(t,e){e.save(),e.globalAlpha=t.opacity,t.data.forEach((t,n)=>{if(!t)return;let i;for(let e=s.tilesets.length-1;e>=0&&(i=s.tilesets[e],!(t/i.firstgid>=1));e--);let r=i.tilewidth||s.tilewidth,o=i.tileheight||s.tileheight,a=i.margin||0,c=i.image,u=t-i.firstgid,h=i.columns||c.width/(r+a)|0,d=n%s.width*r,l=(n/s.width|0)*o,f=u%h*(r+a),p=(u/h|0)*(o+a);e.drawImage(c,f,p,r,o,d,l,r,o)}),e.restore()},layerCanvases:a},t);function c(t){return(s.sy+t)/s.tileheight|0}function u(t){return(s.sx+t)/s.tilewidth|0}function h(t){(s.context||kontra.context).drawImage(t,s.sx,s.sy,kontra.canvas.width,kontra.canvas.height,0,0,kontra.canvas.width,kontra.canvas.height)}return s.tilesets.forEach(e=>{let n=(kontra.assets?kontra.assets._d.get(t):"")||window.location.href;if(e.source){if(!kontra.assets)throw Error('You must use "kontra.assets" to resolve tileset.source');let t=kontra.assets.data[kontra.assets._u(e.source,n)];if(!t)throw Error(`You must load the tileset source "${e.source}" before loading the tileset`);Object.keys(t).forEach(n=>{e[n]=t[n]})}if(""+e.image===e.image){if(!kontra.assets)throw Error('You must use "kontra.assets" to resolve tileset.image');let t=kontra.assets.images[kontra.assets._u(e.image,n)];if(!t)throw Error(`You must load the image "${e.image}" before loading the tileset`);e.image=t}}),s.layers&&s.layers.forEach(t=>{o[t.name]=t,!1!==t.visible&&s._r(t,r)}),s},t.exports=kontra},function(t,e,n){var i=n(8);t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){i(t,e,n[e])})}return t}},function(t,e,n){var i=n(4),r=n(5),o=n(6);t.exports=function(t,e){return i(t)||r(t,e)||o()}},function(t,e,n){t.exports=n(7)},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,n){var i=function(t){"use strict";var e,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function c(t,e,n,i){var r=e&&e.prototype instanceof g?e:g,o=Object.create(r.prototype),a=new O(i||[]);return o._invoke=function(t,e,n){var i=h;return function(r,o){if(i===l)throw new Error("Generator is already running");if(i===f){if("throw"===r)throw o;return I()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=l;var c=u(t,e,n);if("normal"===c.type){if(i=n.done?f:d,c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=f,n.method="throw",n.arg=c.arg)}}}(t,n,a),o}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h="suspendedStart",d="suspendedYield",l="executing",f="completed",p={};function g(){}function m(){}function y(){}var v={};v[o]=function(){return this};var x=Object.getPrototypeOf,w=x&&x(x(P([])));w&&w!==n&&i.call(w,o)&&(v=w);var b=y.prototype=g.prototype=Object.create(v);function k(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function _(t){var e;this._invoke=function(n,r){function o(){return new Promise(function(e,o){!function e(n,r,o,a){var s=u(t[n],t,r);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==typeof h&&i.call(h,"__await")?Promise.resolve(h.__await).then(function(t){e("next",t,o,a)},function(t){e("throw",t,o,a)}):Promise.resolve(h).then(function(t){c.value=t,o(c)},function(t){return e("throw",t,o,a)})}a(s.arg)}(n,r,e,o)})}return e=e?e.then(o,o):o()}}function E(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=u(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,p;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function P(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:I}}function I(){return{value:e,done:!0}}return m.prototype=b.constructor=y,y.constructor=m,y[s]=m.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},k(_.prototype),_.prototype[a]=function(){return this},t.AsyncIterator=_,t.async=function(e,n,i,r){var o=new _(c(e,n,i,r));return t.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},k(b),b[s]="Generator",b[o]=function(){return this},b.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=P,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return s.type="throw",s.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;j(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),p}},t}(t.exports);try{regeneratorRuntime=i}catch(t){Function("r","regeneratorRuntime = r")(i)}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),o=n(2),a=n.n(o),s=n(3),c=n.n(s),u=function(t){return function(t){return c.a.mark(function e(){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.length)){e.next=7;break}return e.next=4,t[n];case 4:n++,e.next=1;break;case 7:case"end":return e.stop()}},e)})}(t)()},h=function(t){return t[t.length-1]},d=function(t){return t[0]},l=function(t,e){return e.filter(function(e){return e.id!==t})},f=function(){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},p=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{onBattleUpdate:function(t){}}).onBattleUpdate,e=[];return{update:function(){if(e.length){var n=h(e);n.update(),n.isComplete()&&(n.exit(),e=l(n.id,e),t(e))}},push:function(n){e.push(n),h(e).enter(),t(n)},currentStateComplete:function(){return!e.length||h(e).hasExited()}}},g=function(t){t.ownerId;var e=t.name,n=(t.target,t.exitParams,t._isComplete),i=void 0!==n&&n,r=t._exited,o=void 0!==r&&r;return{id:"onNotFound",isComplete:function(){return i},hasExited:function(){return o},enter:function(){console.error(e+" tried to enter a state that doesn't exist.")},update:function(){},exit:function(){},fail:function(t){}}},m={onAttack:function(t){var e=t.ownerId,n=t.name,i=t.target,r=t.exitParams,o=t._isComplete,a=void 0!==o&&o,s=t._exited,c=void 0!==s&&s;return{id:"onAttack",isComplete:function(){return a},hasExited:function(){return c},enter:function(){console.log("========== 1 =========="),console.log("%c -> Entered Attack state "+e,"background: #fff3cd; color: #856404"),setTimeout(function(){console.log("%c --\x3e Simulating a fake strike against => "+i.name,"background: #fff3cd; color: #856404"),i.hit({damage:1,originData:{ownerId:e,name:n}})},500),setTimeout(function(){a=!0,console.log("%c <- Attack cycle complete by "+n,"background: #fff3cd; color: #856404")},3e3)},update:function(){},exit:function(){console.log("%c <- Exited Attack State "+e,"background: #fff3cd; color: #856404"),c=!0,r&&r.onExit()},fail:function(t){}}},onHit:function(t){var e=t.ownerId,n=(t.name,t.exitParams),i=t._isComplete,r=void 0!==i&&i,o=t._exited,a=void 0!==o&&o;return{id:"onHit",isComplete:function(){return r},hasExited:function(){return a},enter:function(){console.log("========== 2 =========="),console.log("%c -> Entered onDamaged State"+e,"background: #f8d7da; color: #721c24"),setTimeout(function(){r=!0,console.log("%c -> Finished onDamaged animation!","background: #f8d7da; color: #721c24")},2e3)},update:function(){},exit:function(){console.log("%c <- Exited onDamaged State"+e,"background: #f8d7da; color: #721c24"),a=!0,n&&n.onExit()},fail:function(t){}}},onCounter:function(t){var e=t.ownerId,n=t.name,i=t.target,r=t.exitParams,o=t._isComplete,a=void 0!==o&&o,s=t._exited,c=void 0!==s&&s;return{id:"onCounter",isComplete:function(){return a},hasExited:function(){return c},enter:function(){console.log("========== 3 =========="),console.log("%c----\x3e Execute Counter State For "+n,"background: #cce5ff; color: #004085"),console.log("%c----\x3e Attacking ???","background: #cce5ff; color: #004085"),i.counterHit({damage:1,originData:{ownerId:e,name:n}}),setTimeout(function(){a=!0},5e3)},update:function(){},exit:function(){console.log("%cExited Counter State "+n,"background: #cce5ff; color: #004085"),c=!0,r&&r.onExit()},fail:function(t){}}},onBreak:function(t){t.ownerId;var e=t.name,n=(t.target,t.exitParams,t._isComplete),i=void 0!==n&&n,r=t._exited,o=void 0!==r&&r;return{id:"onBreak",isComplete:function(){return i},hasExited:function(){return o},enter:function(){console.log(e+" entered a break state for debug purposes.")},update:function(){},exit:function(){},fail:function(t){}}}},y=function(t){return Object.keys(m).some(function(e){return e===t})?m[t]:g},v=[{gambitId:"UseAttack",statId:"hp",stateOnTrue:"onAttack",priority:3,condition:function(t,e){return t>=e}},{gambitId:"UsePotion",statId:"hp",stateOnTrue:"onPotion",priority:2,condition:function(t,e){return t<e}},{gambitId:"UseAntidote",statId:"status",stateOnTrue:"onBreak",priority:1,condition:function(t){return"poison"===t}}],x=function(t,e,n){return Math.min(Math.max(t,e),n)},w=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=null;return{id:"status",setStatus:function(n){return e=t.find(function(t){return n===t.type})},clearStatus:function(){return e=null},value:function(){return e?e.type:null}}},b=function(t){var e=t,n=t;return{id:"hp",value:function(){return e},ceil:function(){return n},increaseValue:function(t){e=x(e+t,0,n)},decreaseValue:function(t){e=x(e-t,0,n)}}},_={type:"poison",dmg:1,ticks:3},E=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){},i=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:f()),r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=b(100),a=w([_]);a.setStatus("poison");var s=p();return{name:t,setTarget:function(e){console.log(t+"'s target was set to "+e.name+"."),r=e},update:function(){return s.update()},decide:function(){console.log(t+" is deciding what to do...");var n,s,c=(n=[o,a],(s=d(v.sort(function(t,e){return t.priority-e.priority}).filter(function(t){var e=t.condition,i=t.statId,r=n.find(function(t){return t.id===i});return r&&e(r.value(),r.ceil?r.ceil():null)})))?s.stateOnTrue:null),u=y(c);console.log("Chose state:",c),e.push(u({ownerId:i,target:r,name:t}))},hit:function(a){a.damage;var c=a.originData;console.log(t+" got a hit from "+c.name+".");var u=y("onHit")({ownerId:i,name:t,exitParams:{onExit:function(){n({hp:o}),console.log(t+" decided to counter "+c.name+".");var a=y("onCounter")({ownerId:i,target:r,name:t});e.push(a)}}});s.push(u)},counterHit:function(e){e.damage;var r=e.originData;console.log(t+" got a counter attack hit from "+r.name+".");var a=y("onHit")({ownerId:i,name:t,onExit:function(){n({hp:o})}});s.push(a)},currentStateComplete:function(){return s.currentStateComplete()},onTurnChanged:function(){}}},S=function(t){console.log("There was a battle update."),console.log(t)},j=function(t){console.log("There was an actor update."),console.log(t)},O=function(t){var e=t.participantData;t.onBattleEnded;console.log("New battle started!");var n,i,r=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{onBattleUpdate:function(t){}}).onBattleUpdate,e=[];return{update:function(){if(e.length){var n=d(e);n.update(),n.isComplete()&&(n.exit(),(e=l(n.id,e)).length>0&&d(e).enter(),t(e))}},push:function(n){e.push(n),1===e.length&&d(e).enter(),t(n)},currentStateComplete:function(){return!e.length||d(e).hasExited()}}}({onBattleUpdate:S}),o=e.map(function(t){var e=t.id,n=t.type,i=t.getStats,o=t.setStats,a=t.command;return"player"===n?function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:f(),r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=p();return{name:t,setTarget:function(e){console.log(t+"'s target was set to "+e.name+"."),r=e},update:function(){return o.update()},decide:function(){console.log(t+" is deciding what to do...");var n=y("onAttack")({ownerId:i,target:r,name:t});e.push(n)},hit:function(a){a.damage;var s=a.originData;console.log(t+" got a hit from "+s.name+".");var c=y("onHit")({ownerId:i,name:t,exitParams:{onExit:function(){n({hp:hp}),console.log(t+" decided to counter "+s.name+".");var o=y("onCounter")({ownerId:i,target:r,name:t});e.push(o)}}});o.push(c)},counterHit:function(e){e.damage;var r=e.originData;console.log(t+" got a counter attack hit from "+r.name+".");var a=y("onHit")({ownerId:i,name:t,onExit:function(){n({hp:hp})}});o.push(a)},currentStateComplete:function(){return o.currentStateComplete()},onTurnChanged:function(){}}}(e,r,j,{getStats:i,setStats:o,command:a}):E(e,r,j,{getStats:i,setStats:o,command:a})}),a=(i=u(n=o),{getNextValue:function(){var t=i.next();return t.done?(i=u(n)).next().value:t.value}}),s=[r].concat(o),c=o.find(function(t){return"player-1"===t.name}),h=o.find(function(t){return"gnoll-1"===t.name});c.setTarget(h),h.setTarget(c);return{update:function(){if(r.update(),o.forEach(function(t){return t.update()}),s.every(function(t){return t.currentStateComplete()})){var t=a.getNextValue();console.log("%c"+t.name+"'s turn.","background: #e2e3e5; color: #383d41"),o.map(function(t){return t.onTurnChanged()}),t.decide()}}}},P=function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)},I=[{name:"Open Box",actionId:"open-box",triggeredByType:"box",triggeredById:null},{name:"Save The World",actionId:"save-the-world",triggeredByType:null,triggeredById:"box-2"}],L=function(t){var e=t.entities,n=t.player,i=e.filter(function(t){return"player"!==t.type&&function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)<t.radius+e.width}({x:t.x(),y:t.y(),width:t.width(),radius:t.hitbox().radius},{x:n.x(),y:n.y(),width:n.width(),radius:n.hitbox().radius})}).sort(function(t,e){return P({x:t.x(),y:t.y()},{x:n.x(),y:n.y()})<P({x:e.x(),y:e.y()},{x:n.x(),y:n.y()})});if(i.length){var r=i[0],o=function(t){var e=t.type,n=t.id,i=t.actionTable,r=i.find(function(t){return t.triggeredById===n});if(r)return r.actionId;var o=i.find(function(t){return t.triggeredByType===e});return o?o.actionId:null}({id:r.id,type:r.type,actionTable:I});r.interact(o)}},C=n(1),A=n.n(C),T=function(t){var e=t._disabled,n=void 0!==e&&e,i=t.bindings,r=void 0===i?[]:i,o=t.keyPressedHandler,a=void 0===o?function(t){}:o,s=t.keyMap,c=void 0===s?{right:"right",left:"left",down:"down",up:"up",interact:"e"}:s;return r.map(function(t){var e=t.bind,n=void 0===e?"key":e,i=t.to,r=void 0===i?function(){}:i,o=t.keyBindingMethod;return(void 0===o?function(){}:o)(n,r)}),{enabled:function(t){return n=t},move:function(t){var e=t.speed;return!n&&function(t){var e=t.speed,n=t.keyPressedHandler,i=t.right,r=t.left,o=t.up,a=t.down,s=.1*e;return{x:n(i)?s:n(r)?-s:0,y:n(a)?s:n(o)?-s:0}}(A()({speed:e,keyPressedHandler:a},c))}}},M=[{id:"area-1",entities:[{id:"player-1",type:"player",spriteConfig:{color:"red",x:30,y:30,width:20,height:40},stats:{health:{max:100,min:0,current:50}},hitBox:{radius:1}},{id:"box-1",type:"box",spriteConfig:{color:"blue",x:100,y:50,width:20,height:40},stats:{health:{max:100,min:0,current:50}},hitBox:{radius:1},actions:[{name:"Open",id:"open-box",do:[]}]},{id:"box-2",type:"box",spriteConfig:{color:"green",x:100,y:100,width:20,height:40},stats:{health:{max:100,min:0,current:50}},hitBox:{radius:1},actions:[{name:"Save The World",id:"save-the-world",do:[]}]},{id:"gnoll-1",type:"hostile",spriteConfig:{color:"orange",x:50,y:100,width:20,height:40},stats:{health:{max:100,min:0,current:50}},hitBox:{radius:1},actions:[]}]}],B=function(t){var e=t.id,n=t.type,i=t.stats,r=t.spriteConfig,o=void 0===r?{}:r,a=t.actions,s=void 0===a?[]:a,c=t.hitbox,u=void 0===c?{radius:1}:c,h=t._kontraSprite,d=void 0===h?null:h,l=function(t,e){if(d){var n,i,r,o=(n={x:t,y:e},i=1,0!=(r=Math.sqrt(n.x*n.x+n.y*n.y))&&(n.x=i*n.x/r,n.y=i*n.y/r),{nx:n.x,ny:n.y}),a=o.nx,s=o.ny;d.dx=a,d.dy=s,d.advance()}};return{id:e,type:n,spriteConfig:o,getStats:function(){return i},setStats:function(t){var e=t.k;return console.log("Modify stats:",k,e)},hitbox:function(){return u},move:function(t){var e=t.x,n=t.y;return l(e,n)},interact:function(t){return function(t){if(d){console.log(e,"received signal to",t);var n=s.find(function(e){return e.id===t});n?(console.log("And found an action to match:"),console.log(n)):console.log("But no action was found.")}}(t)},setSprite:function(t){return d=t},x:function(){return d?d.x:0},y:function(){return d?d.y:0},width:function(){return d?d.width:0},height:function(){return d?d.height:0},update:function(){d&&(d.update(),d.x>kontra.canvas.width&&(d.x=-d.width))},render:function(){d&&d.render()}}},D=function(t){return[function(){return t},function(e){return t=e}]},H=document.getElementById("canvas");r.a.init(H);var F,U,N,q,R,z,Y,W,G,$,V,J,X,Q,K,Z,tt,et,nt,it,rt=(F={createSpriteMethod:r.a.sprite,keyPressedHandler:r.a.keys.pressed,keyBindingMethod:r.a.keys.bind},U=F.createSpriteMethod,N=F.keyPressedHandler,q=F.keyBindingMethod,R=D(null),z=a()(R,2),Y=z[0],W=z[1],G=D(!1),$=a()(G,2),V=$[0],J=$[1],X=function(){W(null),J(!1)},Q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{query:"",fromTable:[],createSpriteMethod:function(t){}};console.log("Querying area data for",t.query,"using table data",t.fromTable);var e=t.query,n=t.fromTable,i=t.createSpriteMethod,r=n.find(function(t){return t.id===e}).entities.map(function(t){var e=t.id,n=t.spriteConfig,r=B(t),o=i(A()({id:e},n));return r.setSprite(o),r});return{getEntities:function(){return r},getEntity:function(t){return r.find(function(e){return e.id===t})}}}({query:"area-1",fromTable:M,createSpriteMethod:U}),K=Q.getEntities,Z=Q.getEntity,tt=K(),et=Z("player-1"),nt=Z("gnoll-1"),it=T({keyPressedHandler:N,bindings:[{bind:"e",to:function(){L({entities:tt,player:et})},keyBindingMethod:q},{bind:"b",to:function(){!function(t){if(!V()){var e=O({participantData:t.map(function(t){return{id:t.id,type:t.type,getStats:t.getStats,setStats:t.setStats,command:t.interact}}),onBattleEnded:X});W(e),J(!0)}}([et,nt])},keyBindingMethod:q}]}),{update:function(){if(V())Y().update();else{var t=it.move({speed:10});et.move(t)}tt.forEach(function(t){return t.update()})},render:function(){tt.forEach(function(t){return t.render()})}});r.a.gameLoop({update:function(){rt.update()},render:function(){rt.render()}}).start()}]);